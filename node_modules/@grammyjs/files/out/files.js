"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.installFileMethods = void 0;
const deps_node_js_1 = require("./deps.node.js");
function installFileMethods(file, linkBuilder) {
    const methods = {
        getUrl: () => {
            const path = file.file_path;
            if (path === undefined) {
                const id = file.file_id;
                throw new Error(`File path is not available for file '${id}'`);
            }
            if ((0, deps_node_js_1.isAbsolutePath)(path))
                return path;
            const link = linkBuilder(path);
            if (link instanceof URL)
                return link.href;
            return link;
        },
        download: async (path) => {
            const url = methods.getUrl();
            if (path === undefined)
                path = await (0, deps_node_js_1.createTempFile)();
            if ((0, deps_node_js_1.isAbsolutePath)(url))
                await (0, deps_node_js_1.copyFile)(url, path);
            else
                await (0, deps_node_js_1.downloadFile)(url, path);
            return path;
        },
    };
    Object.assign(file, methods);
}
exports.installFileMethods = installFileMethods;
